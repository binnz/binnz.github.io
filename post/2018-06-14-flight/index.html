<!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Analyze Airline On-time Performance Dataset - California Dreaming</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
  
  <meta name="description" content="In this document, we will walk through the data exploration of Airline on-time performance dataset with Apache Pig as our exploring tool.   We will analyze 8 years of flight data to answer the following 3 analytic questions.

Find the maximal delays (you should consider both ArrDelay and DepDelay) for each month of 2008.
How many flights were delayed caused by weather between 2000 ~ 2005? Please show the counting for each year.
List Top 5 airports which occur delays most in 2007. (Please show the IATA airport code)
">
  
  <meta itemprop="name" content="Analyze Airline On-time Performance Dataset - California Dreaming">
  <meta itemprop="description" content="In this document, we will walk through the data exploration of Airline on-time performance dataset with Apache Pig as our exploring tool.   We will analyze 8 years of flight data to answer the following 3 analytic questions.

Find the maximal delays (you should consider both ArrDelay and DepDelay) for each month of 2008.
How many flights were delayed caused by weather between 2000 ~ 2005? Please show the counting for each year.
List Top 5 airports which occur delays most in 2007. (Please show the IATA airport code)
">
  <meta itemprop="image" content="https://binnz.github.io/img/author.jpg">
  
  
  <meta name="twitter:description" content="">
  
  <link rel="shortcut icon" href="https://binnz.github.io/img/favicon.ico"/>
  <link rel="apple-touch-icon" href="https://binnz.github.io/apple-touch-icon.png" />
  <link rel="apple-touch-icon-precomposed" href="https://binnz.github.io/apple-touch-icon.png" />
  <link rel="stylesheet" href="https://binnz.github.io/highlight/styles/github.css">
  <script src="https://binnz.github.io/highlight/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  
  <link rel="stylesheet" href="https://binnz.github.io/font/hack/css/hack.min.css">
  <link rel="stylesheet" href="https://binnz.github.io/css/style.css">
</head>

<body>
  <header>
    <div>
  <div style="height:150px; width:100%; clear:both;"></div>
  <div id="textlogo">
    <h1 class="site-name"><a href="https://binnz.github.io/" title="California Dreaming">California Dreaming</a></h1>
    <h2 class="blog-motto"></h2>
  </div>
  <div class="navbar"><a class="navbutton navmobile" href="#" title="menu"></a></div>
			<div style="height:50px; width:100%; clear:both;"></div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="menu">
			</a><div style="height:50px; width:100%; clear:both;"></div></div>
  <nav class="animated">
    <ul>
      
      
      <li><a href="/">Home</a></li>
      
      <li><a href="/post/">Archives</a></li>
      
      <li><a href="/tags/">Tags</a></li>
      
      
      <li>
        <form class="search" method="get" action="https://www.google.com/search">
          <div>
            <input type="text" id="search" name="q" placeholder='Search'>
          </div>
        </form>
      </li>
    </ul>
  </nav>
</div>

  </header>
  <div id="container">
    <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody">
    <header class="article-info clearfix">
  <h1 itemprop="name">
      <a href="https://binnz.github.io/post/2018-06-14-flight/" title="Analyze Airline On-time Performance Dataset" itemprop="url">Analyze Airline On-time Performance Dataset</a>
  </h1>
  <p class="article-author">By
    
      <a href="" title="">you</a>
    
  </p>
  <p class="article-time">
    <time datetime="2018-06-14 00:00:00 &#43;0000 UTC" itemprop="datePublished">2018-06-14</time>
  </p>
</header>

	<div class="article-content">
    
    <p>In this document, we will walk through the data exploration of <a href="http://stat-computing.org/dataexpo/2009/">Airline on-time performance dataset</a> with <a href="https://pig.apache.org/">Apache Pig</a> as our exploring tool.   We will analyze <strong>8 years</strong> of flight data to answer the following 3 analytic questions.</p>
<ol>
<li>Find the maximal delays (you should consider both ArrDelay and DepDelay) for each month of 2008.</li>
<li>How many flights were delayed caused by weather between 2000 ~ 2005? Please show the counting for each year.</li>
<li>List Top 5 airports which occur delays most in 2007. (Please show the IATA airport code)</li>
</ol>
<h2 id="i-analytic-tool">I. Analytic Tool</h2>
<p><code>Apache Pig</code> is a platform for analyzing large data sets that consists of a high-level language for expressing data analysis programs, coupled with infrastructure for evaluating these programs. The salient property of Pig programs is that their structure is amenable to substantial parallelization, which in turns enables them to handle very large data sets.</p>
<p>Here are some useful websites:</p>
<ul>
<li><a href="https://pig.apache.org/">Apache Pig Official Website</a></li>
<li><a href="https://www.tutorialspoint.com/apache_pig/index.htm">Apache Pig Tutorials Point</a></li>
</ul>
<p>Simply saying, the data model of <code>Pig Latin</code> is fully nested and it allows complex non-atomic datatypes such as <strong>map</strong> and <strong>tuple</strong>.</p>
<ul>
<li>A <strong>field</strong> is a piece of data.</li>
<li>A <strong>tuple</strong> is a record formed by an ordered set of fields, which can be of any type.
<ul>
<li>A tuple is similar to a row in a table of RDBMS.</li>
<li>Example − <code>(Raja, 30)</code></li>
</ul>
</li>
<li>A <strong>bag</strong> is an unordered set of tuples. In other words, a collection of tuples (non-unique) is known as a bag. Each tuple can have any number of fields (flexible schema).
<ul>
<li>A bag is similar to a table in RDBMS, but it is not necessary that every tuple contain the same schema.</li>
<li>Example − <code>{(Raja, 30), (Mohammad, 45)}</code></li>
</ul>
</li>
<li>A <strong>map</strong> (or data map) is a set of key-value pairs. The key needs to be of type chararray and should be unique. The value might be of any type.
<ul>
<li>Example − <code>[name#Raja, age#30]</code></li>
</ul>
</li>
</ul>
<p>Note that a <strong>Relation</strong> is the outermost structure of the Pig Latin data model, which is also a <strong>bag</strong> where <strong>inner bags</strong> are allowed.   Except <code>LOAD</code> and <code>STORE</code>, while performing all other operations, Pig Latin statements take a relation as input and produce another relation as output.</p>
<h2 id="ii-dataset">II. Dataset</h2>
<p><a href="http://stat-computing.org/dataexpo/2009/">Airline on-time performance dataset</a> consists of flight arrival and departure details for all commercial flights within the USA, from October 1987 to April 2008. This is a large dataset: there are nearly <strong>120 million records</strong> in total, and takes up <strong>1.6 gigabytes of space</strong> compressed and 12 gigabytes when uncompressed.</p>
<h3 id="a-supplement-data">A. Supplement Data</h3>
<p>If you need further information, the <a href="http://stat-computing.org/dataexpo/2009/supplemental-data.html">supplement data</a> describes the locations of US airports, listing of carrier codes, information about individual planes, and meteorological data.</p>
<h3 id="b-flight-data">B. Flight Data</h3>
<p>The Schema of the flight data is as follows</p>
<ul>
<li>Year int,</li>
<li>Month int,</li>
<li>DayofMonth int,</li>
<li>DayOfWeek int,</li>
<li>DepTime  int,</li>
<li>CRSDepTime int,</li>
<li>ArrTime int,</li>
<li>CRSArrTime int,</li>
<li>UniqueCarrier varchar(5),</li>
<li>FlightNum int,</li>
<li>TailNum varchar(8),</li>
<li>ActualElapsedTime int,</li>
<li>CRSElapsedTime int,</li>
<li>AirTime int,</li>
<li>ArrDelay int,</li>
<li>DepDelay int,</li>
<li>Origin varchar(3),</li>
<li>Dest varchar(3),</li>
<li>Distance int,</li>
<li>TaxiIn int,</li>
<li>TaxiOut int,</li>
<li>Cancelled int,</li>
<li>CancellationCode varchar(1),</li>
<li>Diverted varchar(1),</li>
<li>CarrierDelay int,</li>
<li>WeatherDelay int,</li>
<li>NASDelay int,</li>
<li>SecurityDelay int,</li>
<li>LateAircraftDelay int</li>
</ul>
<p>Here the flight dataset from <code>2000</code> to <code>2008</code> is downloaded to the directory <code>data/</code> using the shell command <code>wget</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sh" data-lang="sh">%sh

mkdir data
<span class="k">for</span> i in <span class="m">2000</span> <span class="m">2001</span> <span class="m">2002</span> <span class="m">2003</span> <span class="m">2004</span> <span class="m">2005</span> <span class="m">2007</span> <span class="m">2008</span>
<span class="k">do</span>
  wget -nv -O data/<span class="nv">$i</span>.csv.bz2 http://stat-computing.org/dataexpo/2009/<span class="nv">$i</span>.csv.bz2
<span class="k">done</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="iii-analytic-problems">III. Analytic Problems</h2>
<p>To solve the analytic problems, first we <strong>load the data</strong> from <code>2000</code> to <code>2008</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-pig" data-lang="pig"><span class="o">%</span><span class="k">pig</span>

dataset_raw <span class="o">=</span> <span class="k">LOAD</span> <span class="s">&#39;data/{2000,2001,2002,2003,2004,2005,2007,2008}.csv.bz2&#39;</span> 
    <span class="k">USING</span> <span class="nb">PigStorage</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">)</span> <span class="k">AS</span> <span class="p">(</span>Year:<span class="kt">chararray</span><span class="o">,</span> Month:<span class="kt">chararray</span><span class="o">,</span> DayofMonth:<span class="kt">chararray</span><span class="o">,</span> 
    DayOfWeek:<span class="kt">chararray</span><span class="o">,</span> DepTime:<span class="kt">chararray</span><span class="o">,</span> CRSDepTime:<span class="kt">chararray</span><span class="o">,</span> ArrTime:<span class="kt">chararray</span><span class="o">,</span> 
    CRSArrTime:<span class="kt">chararray</span><span class="o">,</span> UniqueCarrier:<span class="kt">chararray</span><span class="o">,</span> FlightNum:<span class="kt">chararray</span><span class="o">,</span> 
    TailNum:<span class="kt">chararray</span><span class="o">,</span> ActualElapsedTime:<span class="kt">chararray</span><span class="o">,</span> CRSElapsedTime:<span class="kt">chararray</span><span class="o">,</span> 
    AirTime:<span class="kt">chararray</span><span class="o">,</span> ArrDelay:<span class="kt">int</span><span class="o">,</span> DepDelay:<span class="kt">int</span><span class="o">,</span> Origin:<span class="kt">chararray</span><span class="o">,</span> Dest:<span class="kt">chararray</span><span class="o">,</span> 
    Distance:<span class="kt">chararray</span><span class="o">,</span> TaxiIn:<span class="kt">chararray</span><span class="o">,</span> TaxiOut:<span class="kt">chararray</span><span class="o">,</span> Cancelled:<span class="kt">chararray</span><span class="o">,</span> 
    CancellationCode:<span class="kt">chararray</span><span class="o">,</span> Diverted:<span class="kt">chararray</span><span class="o">,</span> CarrierDelay:<span class="kt">chararray</span><span class="o">,</span> 
    WeatherDelay:<span class="kt">int</span><span class="o">,</span> NASDelay:<span class="kt">chararray</span><span class="o">,</span> SecurityDelay:<span class="kt">chararray</span><span class="o">,</span> 
    LateAircraftDelay:<span class="kt">chararray</span><span class="p">);</span> 
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">dataset = FILTER dataset_raw BY Year != &#39;Year&#39;;

tmp = LIMIT dataset 2;
DUMP tmp;
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">(2000,1,28,5,1647,1647,1906,1859,HP,154,N808AW,259,252,233,7,0,ATL,PHX,1587,15,11,0,NA,0,NA,,NA,NA,NA)
(2000,1,29,6,1648,1647,1939,1859,HP,154,N653AW,291,252,239,40,1,ATL,PHX,1587,5,47,0,NA,0,NA,,NA,NA,NA)
</code></pre></td></tr></table>
</div>
</div><h3 id="q1-find-the-maximal-delays-you-should-consider-both-arrdelay-and-depdelay-for-each-month-of-2008">Q1. Find the maximal delays (you should consider both <code>ArrDelay</code> and <code>DepDelay</code>) for each month of <code>2008</code>.</h3>
<p>From the dataset that consists of flight records from <code>2000</code> to <code>2008</code>, I extract records of <code>2008</code> and group these records acoording to the <code>month</code> of the flight.   For each group, we sort the departure delays and the arrival delays and then pick the top ones to show.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-pig" data-lang="pig"><span class="o">%</span><span class="k">pig</span>

data_2008 <span class="o">=</span> <span class="k">FILTER</span> dataset <span class="k">BY</span> Year <span class="o">==</span> <span class="s">&#39;2008&#39;</span><span class="p">;</span>
records <span class="o">=</span> <span class="k">FOREACH</span> data_2008 <span class="k">GENERATE</span> Month, ArrDelay, DepDelay,
            <span class="p">(</span>ArrDelay <span class="o">+</span> DepDelay<span class="p">)</span> <span class="k">AS</span> SumDelay;
grpd <span class="o">=</span> <span class="k">GROUP</span> records <span class="k">BY</span> Month;

top_delays <span class="o">=</span> <span class="k">FOREACH</span> grpd <span class="p">{</span>
 arr_delays <span class="o">=</span> <span class="k">ORDER</span> records <span class="k">BY</span> ArrDelay <span class="k">DESC</span><span class="p">;</span>
 dep_delays <span class="o">=</span> <span class="k">ORDER</span> records <span class="k">BY</span> DepDelay <span class="k">DESC</span><span class="p">;</span>
 sum_delays <span class="o">=</span> <span class="k">ORDER</span> records <span class="k">BY</span> SumDelay <span class="k">DESC</span><span class="p">;</span>
 arr_delays_top1 <span class="o">=</span> <span class="k">LIMIT</span> arr_delays <span class="mi">1</span><span class="p">;</span>
 dep_delays_top1 <span class="o">=</span> <span class="k">LIMIT</span> dep_delays <span class="mi">1</span><span class="p">;</span>
 sum_delays_top1 <span class="o">=</span> <span class="k">LIMIT</span> sum_delays <span class="mi">1</span><span class="p">;</span>
 <span class="k">GENERATE</span> <span class="k">group</span> <span class="k">AS</span> Month, <span class="k">FLATTEN</span><span class="p">(</span>arr_delays_top1.ArrDelay<span class="p">)</span> <span class="k">AS</span> ArrDelay, 
          <span class="k">FLATTEN</span><span class="p">(</span>dep_delays_top1.DepDelay<span class="p">)</span> <span class="k">AS</span> DepDelay,
          <span class="k">FLATTEN</span><span class="p">(</span>sum_delays_top1.SumDelay<span class="p">)</span> <span class="k">AS</span> SumDelay; 
<span class="p">};</span>

<span class="k">DUMP</span> top_delays;
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">(1,1525,1355,2800)
(2,2461,2457,4918)
(3,1490,1521,2980)
(4,2453,2467,4920)
(5,1951,1952,3903)
(6,1707,1710,3417)
(7,1510,1518,3028)
(8,1359,1367,2726)
(9,1583,1552,3135)
(10,1392,1369,2761)
(11,1308,1286,2594)
(12,1655,1597,3252)
</code></pre></td></tr></table>
</div>
</div><p>The query result is stored into the folder <code>q1</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-pig" data-lang="pig"><span class="o">%</span><span class="k">pig</span>

<span class="k">STORE</span> top_delays <span class="k">INTO</span> <span class="s">&#39;q1&#39;</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p>So that we can read the query result and visualize the top delays for each month.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">%</span><span class="n">python</span>

<span class="kn">import</span> <span class="nn">glob</span><span class="o">,</span> <span class="nn">os</span> 
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Read file</span>

<span class="n">all_rec</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">iglob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&#34;q1&#34;</span><span class="p">,</span> <span class="s2">&#34;part*&#34;</span><span class="p">),</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>    
<span class="n">dataframes</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&#34;</span><span class="se">\t</span><span class="s2">&#34;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">all_rec</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dataframes</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">,</span><span class="s1">&#39;Top Arrival Delay&#39;</span><span class="p">,</span> <span class="s1">&#39;Top Departure Delay&#39;</span><span class="p">,</span> <span class="s1">&#39;Top (Arrival Delay + Departure Delay)&#39;</span><span class="p">]</span>

<span class="c1"># Convert minutes to hours</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">col</span> <span class="o">==</span> <span class="s1">&#39;Month&#39;</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">60</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]]</span>
<span class="n">df</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">    Month  Top Arrival Delay  Top Departure Delay  \
0       1          25.416667            22.583333   
1       2          41.016667            40.950000   
2       3          24.833333            25.350000   
3       4          40.883333            41.116667   
4       5          32.516667            32.533333   
5       6          28.450000            28.500000   
6       7          25.166667            25.300000   
7       8          22.650000            22.783333   
8       9          26.383333            25.866667   
9      10          23.200000            22.816667   
10     11          21.800000            21.433333   
11     12          27.583333            26.616667   

    Top (Arrival Delay + Departure Delay)  
0                               46.666667  
1                               81.966667  
2                               49.666667  
3                               82.000000  
4                               65.050000  
5                               56.950000  
6                               50.466667  
7                               45.433333  
8                               52.250000  
9                               46.016667  
10                              43.233333  
11                              54.200000  
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">%</span><span class="n">python</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Top Arrival Delay&#39;</span><span class="p">,</span> <span class="s1">&#39;Top Departure Delay&#39;</span><span class="p">,</span> 
                            <span class="s1">&#39;Top (Arrival Delay + Departure Delay)&#39;</span><span class="p">],</span> 
             <span class="n">kind</span><span class="o">=</span><span class="s2">&#34;line&#34;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&#34;-o&#34;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&#34;The Maximal Delays for Each Month in 2008&#34;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;hour(s)&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">&lt;matplotlib.text.Text object at 0x114d074e0&gt;
</code></pre></td></tr></table>
</div>
</div><p><img src="https://i.imgur.com/vBXbRaz.png" alt=""></p>
<p>From the table and the figure shown above, we can see that in 2008,</p>
<ol>
<li>the <strong>largest arrival delay</strong> happens in <code>February</code> and <code>April</code>, which are also when the <strong>largest departure delay</strong> occurs.</li>
<li>the <strong>smallest arrival delay</strong> and the <strong>smallest departure delay</strong> both occur in <code>November</code>.</li>
<li>the maximal delays in summer and autumn is smaller than the maximal delays in winter and spring.</li>
</ol>
<h3 id="q2-how-many-flights-were-delayed-caused-by-weather-between-2000--2005-please-show-the-counting-for-each-year">Q2. How many flights were delayed caused by weather between <code>2000 ~ 2005</code>? Please show the counting for each year.</h3>
<p>To answer this question, I retreive flight records needed and group them by the <code>Year</code> of the flights.   For each group, I count the number of flight records whose <code>WeatherDealy</code> is more than 0 minute(s) and show the calculation results.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-pig" data-lang="pig"><span class="o">%</span><span class="k">pig</span>
data_q2 <span class="o">=</span> <span class="k">FILTER</span> dataset <span class="k">BY</span> <span class="p">(</span>Year <span class="o">!=</span> <span class="s">&#39;2008&#39;</span><span class="p">)</span> <span class="k">AND</span> <span class="p">(</span>Year <span class="o">!=</span> <span class="s">&#39;2007&#39;</span><span class="p">);</span>
records <span class="o">=</span> <span class="k">FOREACH</span> data_q2 <span class="k">GENERATE</span> Year, WeatherDelay;
grpd <span class="o">=</span> <span class="k">GROUP</span> records <span class="k">BY</span> Year;
q2 <span class="o">=</span> <span class="k">FOREACH</span> grpd <span class="p">{</span>
    weather_delays <span class="o">=</span> <span class="k">FILTER</span> records <span class="k">BY</span> WeatherDelay <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">GENERATE</span> <span class="k">group</span><span class="o">,</span> <span class="nb">COUNT</span><span class="p">(</span>weather_delays<span class="p">);</span> 
<span class="p">};</span>

<span class="k">DUMP</span> q2;
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">(2000,0)
(2001,0)
(2002,0)
(2003,44620)
(2004,115989)
(2005,111388)
</code></pre></td></tr></table>
</div>
</div><p>The query result is stored into the folder <code>q2</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-pig" data-lang="pig"><span class="o">%</span><span class="k">pig</span>

<span class="k">STORE</span> q2 <span class="k">INTO</span> <span class="s">&#39;q2&#39;</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p>So that we can read the query result and visualize the count of weather delays for each year.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">%</span><span class="n">python</span>

<span class="kn">import</span> <span class="nn">glob</span><span class="o">,</span> <span class="nn">os</span> 
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Read file</span>
<span class="n">all_rec</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">iglob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&#34;q2&#34;</span><span class="p">,</span> <span class="s2">&#34;part*&#34;</span><span class="p">),</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>    
<span class="n">dataframes</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&#34;</span><span class="se">\t</span><span class="s2">&#34;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">all_rec</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dataframes</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span><span class="s1">&#39;Weather Delay&#39;</span><span class="p">]</span>

<span class="n">df</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">   Year  Weather Delay
0  2000              0
1  2001              0
2  2002              0
3  2003          44620
4  2004         115989
5  2005         111388
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">%</span><span class="n">python</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Weather Delay&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&#34;line&#34;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&#34;-o&#34;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&#34;The Count of Weather Delay for Each Year&#34;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">&lt;matplotlib.text.Text object at 0x11a972ac8&gt;
</code></pre></td></tr></table>
</div>
</div><p><img src="https://i.imgur.com/w9oDPX9.png" alt=""></p>
<p>From the table and the figure above, we can find that</p>
<ol>
<li>There are no weather delays from <code>2000</code> to <code>2002</code> in flight records.   However, I think this may due to the missing of the data or the fact that they did not record if a dealy flight is caused by weather before <code>2003</code>.</li>
<li>There are more weather delays in <code>2004</code> than that in <code>2003</code>, which may be partially driven by the increase in the total number of flights.</li>
<li>Unexpectedly, the count of weather delays in <code>2005</code> is less than that in <code>2004</code>.</li>
</ol>
<h3 id="q3-list-top-5-airports-which-occur-delays-most-in-2007-please-show-the-iata-airport-code">Q3. List Top 5 airports which occur delays most in <code>2007</code>. (Please show the <code>IATA</code> airport code)</h3>
<p>In the following operation on <code>pig</code> dataset, I first retreive only the flight data in <code>2007</code>, and then group the delay flights by their departure airport to <strong>count the frequency of occuring departure delay for each airport</strong>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-pig" data-lang="pig"><span class="o">%</span><span class="k">pig</span>

data_q3 <span class="o">=</span> <span class="k">FILTER</span> dataset <span class="k">BY</span> <span class="p">(</span>Year <span class="o">==</span> <span class="s">&#39;2007&#39;</span><span class="p">)</span> <span class="k">AND</span> <span class="p">(</span>DepDelay <span class="o">&gt;</span> <span class="mi">0</span><span class="p">);</span>
records <span class="o">=</span> <span class="k">FOREACH</span> data_q3 <span class="k">GENERATE</span> Origin, DepDelay;
grpd <span class="o">=</span> <span class="k">GROUP</span> records <span class="k">BY</span> Origin;
counts <span class="o">=</span> <span class="k">FOREACH</span> grpd <span class="k">GENERATE</span> <span class="k">group</span> <span class="k">AS</span> Airport, 
                               <span class="nb">COUNT</span><span class="p">(</span>records<span class="p">)</span> <span class="k">AS</span> DelayCount;
sorted <span class="o">=</span> <span class="k">ORDER</span> counts <span class="k">BY</span> DelayCount <span class="k">DESC</span><span class="p">;</span>
q3_1 <span class="o">=</span> <span class="k">LIMIT</span> sorted <span class="mi">5</span><span class="p">;</span>

<span class="k">DUMP</span> q3_1;
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">(ATL,206118)
(ORD,183984)
(DFW,135433)
(DEN,109839)
(PHX,105917)
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-pig" data-lang="pig"><span class="o">%</span><span class="k">pig</span>

data_q3 <span class="o">=</span> <span class="k">FILTER</span> dataset <span class="k">BY</span> <span class="p">(</span>Year <span class="o">==</span> <span class="s">&#39;2007&#39;</span><span class="p">)</span> <span class="k">AND</span> <span class="p">(</span>ArrDelay <span class="o">&gt;</span> <span class="mi">0</span><span class="p">);</span>
records <span class="o">=</span> <span class="k">FOREACH</span> data_q3 <span class="k">GENERATE</span> Origin, ArrDelay;
grpd <span class="o">=</span> <span class="k">GROUP</span> records <span class="k">BY</span> Origin;
counts <span class="o">=</span> <span class="k">FOREACH</span> grpd <span class="k">GENERATE</span> <span class="k">group</span> <span class="k">AS</span> Airport, 
                               <span class="nb">COUNT</span><span class="p">(</span>records<span class="p">)</span> <span class="k">AS</span> DelayCount;
sorted <span class="o">=</span> <span class="k">ORDER</span> counts <span class="k">BY</span> DelayCount <span class="k">DESC</span><span class="p">;</span>
q3_2 <span class="o">=</span> <span class="k">LIMIT</span> sorted <span class="mi">5</span><span class="p">;</span>

<span class="k">DUMP</span> q3_2;
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">(ATL,209826)
(ORD,188410)
(DFW,148059)
(DEN,122557)
(LAX,113379)
</code></pre></td></tr></table>
</div>
</div><p>The query result is stored into the folder <code>q3</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-pig" data-lang="pig"><span class="o">%</span><span class="k">pig</span>

<span class="k">STORE</span> q3_1 <span class="k">INTO</span> <span class="s">&#39;q3/dep&#39;</span><span class="p">;</span>
<span class="k">STORE</span> q3_2 <span class="k">INTO</span> <span class="s">&#39;q3/arr&#39;</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p>So that we can read the query result and visualize the top airports that occur departure/arrival delays the most.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">%</span><span class="n">python</span>

<span class="kn">import</span> <span class="nn">glob</span><span class="o">,</span> <span class="nn">os</span> 
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Read file</span>
<span class="n">rec_dep</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">iglob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&#34;q3&#34;</span><span class="p">,</span> <span class="s2">&#34;dep&#34;</span><span class="p">,</span> <span class="s2">&#34;part*&#34;</span><span class="p">),</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>    
<span class="n">rec_arr</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">iglob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&#34;q3&#34;</span><span class="p">,</span> <span class="s2">&#34;arr&#34;</span><span class="p">,</span> <span class="s2">&#34;part*&#34;</span><span class="p">),</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>    
<span class="n">df_dep</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&#34;</span><span class="se">\t</span><span class="s2">&#34;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">rec_dep</span><span class="p">],</span> 
                <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_arr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&#34;</span><span class="se">\t</span><span class="s2">&#34;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">rec_arr</span><span class="p">],</span> 
                <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_dep</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Airport&#39;</span><span class="p">,</span> <span class="s1">&#39;Departure Delay&#39;</span><span class="p">]</span>
<span class="n">df_arr</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Airport&#39;</span><span class="p">,</span> <span class="s1">&#39;Arrival Delay&#39;</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">%</span><span class="n">python</span>

<span class="n">df_dep</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">  Airport  Departure Delay
0     ATL           206118
1     ORD           183984
2     DFW           135433
3     DEN           109839
4     PHX           105917
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">%</span><span class="n">python</span>

<span class="n">df_arr</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">  Airport  Arrival Delay
0     ATL         209826
1     ORD         188410
2     DFW         148059
3     DEN         122557
4     LAX         113379
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">%</span><span class="n">python</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">df_dep</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Airport&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Departure Delay&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&#34;bar&#34;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&#34;The Top 5 Airports that Occur Departure Delays Most Frequently in 2007&#34;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">&lt;matplotlib.text.Text object at 0x105a84128&gt;
</code></pre></td></tr></table>
</div>
</div><p><img src="https://i.imgur.com/yO1IuAx.png" alt=""></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">%</span><span class="n">python</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">df_arr</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Airport&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Arrival Delay&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&#34;bar&#34;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&#34;The Top 5 Airports that Occur Arrival Delays Most Frequently in 2007&#34;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">&lt;matplotlib.text.Text object at 0x10e9df278&gt;
</code></pre></td></tr></table>
</div>
</div><p><img src="https://i.imgur.com/G5GBud6.png" alt=""></p>
<p>The top 4 airports that occurs delay the most times are the same for departure delay and arrival delay, which are</p>
<ol>
<li><code>ATL</code> - William B Hartsfield-Atlanta Intl Airport in <strong>Atlanta</strong></li>
<li><code>ORD</code> - Chicago O&rsquo;Hare International Airport in <strong>Chicago</strong></li>
<li><code>DFW</code> - Dallas-Fort Worth International Airport in <strong>Dallas-Fort Worth</strong></li>
<li><code>DEN</code> - Denver Intl Airport in <strong>Denver</strong></li>
</ol>
<p>However, the 5th highest departure delay count occurs at</p>
<ol start="5">
<li><code>PHX</code> - Phoenix Sky Harbor International Airport in <strong>Phoenix</strong></li>
</ol>
<p>while the 5th highest arrival delay count occurs at</p>
<ol start="5">
<li><code>LAX</code> - Los Angeles International in <strong>Los Angeles</strong></li>
</ol>
    
	</div>
  <footer class="article-footer clearfix">
  

<div class="article-tags">
  <span></span>
  
  <a href="https://binnz.github.io/tags/data-mining">Data-Mining</a>
  
  <a href="https://binnz.github.io/tags/apache-pig">Apache-Pig</a>
  
</div>





<div class="article-categories">
  <span></span>
  
  <a class="article-category-link" href="https://binnz.github.io/categories/programming">Programming</a>
  
</div>



  <div class="article-share" id="share">
    <div data-url="https://binnz.github.io/post/2018-06-14-flight/" data-title="Analyze Airline On-time Performance Dataset" data-tsina="" class="share clearfix">
    </div>
  </div>
</footer>

	</article>
  


<section class="comment">
<div id="disqus_thread"></div>
</section>
<script>
  <!-- detect whether Disuqs can load -->
  var xhr = new XMLHttpRequest();
  xhr.open('GET', '//disqus.com/next/config.json?' + new Date().getTime(), true);
  xhr.timeout = 3000; 

  xhr.onload = function() { 


var disqus_config = function () {
this.page.url = "https://binnz.github.io/post/2018-06-14-flight/";
this.page.identifier = "https://binnz.github.io/post/2018-06-14-flight/";
};
(function() { 
var d = document, s = d.createElement('script');

s.src = '//disc.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
}
  xhr.ontimeout = function() {
  <!-- cannot load Disqus, skip it. -->
  return;
}
xhr.send(null);
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


</div>

    <div class="openaside"><a class="navbutton" href="#" title="Show SideBar"></a></div>
<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide SideBar"></a></div>
<aside class="clearfix">
  

<div class="categorieslist">
  <p class="asidetitle">Categories</p>
  <ul>
    
    <li><a href="https://binnz.github.io/categories/install" title="install">install<sup>2</sup></a></li>
    
    <li><a href="https://binnz.github.io/categories/life" title="life">life<sup>1</sup></a></li>
    
    <li><a href="https://binnz.github.io/categories/notes" title="notes">notes<sup>50</sup></a></li>
    
    <li><a href="https://binnz.github.io/categories/programming" title="programming">programming<sup>25</sup></a></li>
    
    <li><a href="https://binnz.github.io/categories/projects" title="projects">projects<sup>2</sup></a></li>
    
    <li><a href="https://binnz.github.io/categories/publications" title="publications">publications<sup>1</sup></a></li>
    
  </ul>
</div>



  

<div class="tagslist">
	<p class="asidetitle">Tags</p>
		<ul class="clearfix">
      
			<li><a href="https://binnz.github.io/tags/ANDROID" title="android">android<sup>1</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/APACHE-PIG" title="apache-pig">apache-pig<sup>1</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/ASSOCIATION-ANALYSIS" title="association-analysis">association-analysis<sup>9</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/BEER" title="beer">beer<sup>1</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/CLASSIFICATION" title="classification">classification<sup>9</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/CLUSTERING" title="clustering">clustering<sup>19</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/CONFERENCE" title="conference">conference<sup>1</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/DATA-MINING" title="data-mining">data-mining<sup>64</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/DATA-SCIENCE" title="data-science">data-science<sup>1</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/DATABASE" title="database">database<sup>1</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/DEEP-LEARNING" title="deep-learning">deep-learning<sup>2</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/ELASTICSEARCH" title="elasticsearch">elasticsearch<sup>2</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/GRAPH" title="graph">graph<sup>12</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/HADOOP" title="hadoop">hadoop<sup>1</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/INFORMATION-RETRIEVAL" title="information-retrieval">information-retrieval<sup>1</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/JAVA" title="java">java<sup>5</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/MACHINE-LEARNING" title="machine-learning">machine-learning<sup>5</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/NEURAL-NETWORK" title="neural-network">neural-network<sup>2</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/NLP" title="nlp">nlp<sup>4</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/NLTK" title="nltk">nltk<sup>1</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/PYTHON" title="python">python<sup>15</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/R" title="r">r<sup>4</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/RELATION-ALGEBRA" title="relation-algebra">relation-algebra<sup>1</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/SCIKIT-LEARN" title="scikit-learn">scikit-learn<sup>5</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/SPARK" title="spark">spark<sup>9</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/SQL" title="sql">sql<sup>3</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/STATISTICS" title="statistics">statistics<sup>5</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/STREAMING" title="streaming">streaming<sup>1</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/TIME-SERIES" title="time-series">time-series<sup>2</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/TRAVEL" title="travel">travel<sup>1</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/UNIT-TEST" title="unit-test">unit-test<sup>1</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/VBA" title="vba">vba<sup>1</sup></a></li>
      
			<li><a href="https://binnz.github.io/tags/WINDOWS" title="windows">windows<sup>1</sup></a></li>
      
		</ul>
</div>



  
  <div class="archiveslist">
    <p class="asidetitle">Archives</p>
    <ul class="archive-list">
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="https://binnz.github.io/post/#2021-06">2021年06月</a><span class="archive-list-count">1</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="https://binnz.github.io/post/#2020-05">2020年05月</a><span class="archive-list-count">12</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="https://binnz.github.io/post/#2019-09">2019年09月</a><span class="archive-list-count">1</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="https://binnz.github.io/post/#2018-09">2018年09月</a><span class="archive-list-count">4</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="https://binnz.github.io/post/#2018-08">2018年08月</a><span class="archive-list-count">1</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="https://binnz.github.io/post/#2018-06">2018年06月</a><span class="archive-list-count">2</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="https://binnz.github.io/post/#2018-05">2018年05月</a><span class="archive-list-count">4</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="https://binnz.github.io/post/#2018-04">2018年04月</a><span class="archive-list-count">5</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="https://binnz.github.io/post/#2018-03">2018年03月</a><span class="archive-list-count">5</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="https://binnz.github.io/post/#2018-01">2018年01月</a><span class="archive-list-count">2</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="https://binnz.github.io/post/#2017-12">2017年12月</a><span class="archive-list-count">1</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="https://binnz.github.io/post/#2017-11">2017年11月</a><span class="archive-list-count">1</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="https://binnz.github.io/post/#2017-10">2017年10月</a><span class="archive-list-count">1</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="https://binnz.github.io/post/#2017-09">2017年09月</a><span class="archive-list-count">10</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="https://binnz.github.io/post/#2017-08">2017年08月</a><span class="archive-list-count">2</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="https://binnz.github.io/post/#2017-07">2017年07月</a><span class="archive-list-count">4</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="https://binnz.github.io/post/#2017-05">2017年05月</a><span class="archive-list-count">3</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="https://binnz.github.io/post/#2017-04">2017年04月</a><span class="archive-list-count">2</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="https://binnz.github.io/post/#2017-03">2017年03月</a><span class="archive-list-count">20</span>
      </li>
      
    </ul>

  </div>


  

<div class="tagcloudlist">
  <p class="asidetitle">Tags Cloud</p>
  <div class="tagcloudlist clearfix">
    
    <a href="https://binnz.github.io/tags/android" style="font-size: 12px;">android</a>
    
    <a href="https://binnz.github.io/tags/apache-pig" style="font-size: 12px;">apache-pig</a>
    
    <a href="https://binnz.github.io/tags/association-analysis" style="font-size: 12px;">association-analysis</a>
    
    <a href="https://binnz.github.io/tags/beer" style="font-size: 12px;">beer</a>
    
    <a href="https://binnz.github.io/tags/classification" style="font-size: 12px;">classification</a>
    
    <a href="https://binnz.github.io/tags/clustering" style="font-size: 12px;">clustering</a>
    
    <a href="https://binnz.github.io/tags/conference" style="font-size: 12px;">conference</a>
    
    <a href="https://binnz.github.io/tags/data-mining" style="font-size: 12px;">data-mining</a>
    
    <a href="https://binnz.github.io/tags/data-science" style="font-size: 12px;">data-science</a>
    
    <a href="https://binnz.github.io/tags/database" style="font-size: 12px;">database</a>
    
    <a href="https://binnz.github.io/tags/deep-learning" style="font-size: 12px;">deep-learning</a>
    
    <a href="https://binnz.github.io/tags/elasticsearch" style="font-size: 12px;">elasticsearch</a>
    
    <a href="https://binnz.github.io/tags/graph" style="font-size: 12px;">graph</a>
    
    <a href="https://binnz.github.io/tags/hadoop" style="font-size: 12px;">hadoop</a>
    
    <a href="https://binnz.github.io/tags/information-retrieval" style="font-size: 12px;">information-retrieval</a>
    
    <a href="https://binnz.github.io/tags/java" style="font-size: 12px;">java</a>
    
    <a href="https://binnz.github.io/tags/machine-learning" style="font-size: 12px;">machine-learning</a>
    
    <a href="https://binnz.github.io/tags/neural-network" style="font-size: 12px;">neural-network</a>
    
    <a href="https://binnz.github.io/tags/nlp" style="font-size: 12px;">nlp</a>
    
    <a href="https://binnz.github.io/tags/nltk" style="font-size: 12px;">nltk</a>
    
    <a href="https://binnz.github.io/tags/python" style="font-size: 12px;">python</a>
    
    <a href="https://binnz.github.io/tags/r" style="font-size: 12px;">r</a>
    
    <a href="https://binnz.github.io/tags/relation-algebra" style="font-size: 12px;">relation-algebra</a>
    
    <a href="https://binnz.github.io/tags/scikit-learn" style="font-size: 12px;">scikit-learn</a>
    
    <a href="https://binnz.github.io/tags/spark" style="font-size: 12px;">spark</a>
    
    <a href="https://binnz.github.io/tags/sql" style="font-size: 12px;">sql</a>
    
    <a href="https://binnz.github.io/tags/statistics" style="font-size: 12px;">statistics</a>
    
    <a href="https://binnz.github.io/tags/streaming" style="font-size: 12px;">streaming</a>
    
    <a href="https://binnz.github.io/tags/time-series" style="font-size: 12px;">time-series</a>
    
    <a href="https://binnz.github.io/tags/travel" style="font-size: 12px;">travel</a>
    
    <a href="https://binnz.github.io/tags/unit-test" style="font-size: 12px;">unit-test</a>
    
    <a href="https://binnz.github.io/tags/vba" style="font-size: 12px;">vba</a>
    
    <a href="https://binnz.github.io/tags/windows" style="font-size: 12px;">windows</a>
    
  </div>
</div>



  

</aside>
</div>

  </div>
  <footer><div id="footer" >
  <div class="line">
    <span></span>
    
    <div style='background:no-repeat url("https://binnz.github.io/img/US-MT-EPS-02-6001.png") left top;-webkit-background-size:6.875em 6.875em;-moz-background-size:6.875em 6.875em;background-size:6.875em 6.875em;' class="author" ></div>
  </div>
  <section class="info">
    <p>hehe</p>
  </section>
  <div class="social-font clearfix">
    <a href='http://weibo.com/coderzh' target="_blank" title="weibo"></a>
    <a href='https://twitter.com/coderzh' target="_blank" title="twitter"></a>
    <a href='https://github.com/binnz' target="_blank" class="icon-github" title="github"></a>
    <a href='https://www.facebook.com/coderzh' target="_blank" title="facebook"></a>
    <a href='https://www.linkedin.com/coderzh' target="_blank" title="linkedin"></a>
  </div>
  <p class="copyright">Powered by <a href="http://gohugo.io" target="_blank" title="hugo">hugo</a> and Theme by <a href="https://github.com/coderzh/hugo-pacman-theme" target="_blank" title="hugo-pacman-theme">hugo-pacman-theme</a> © 2021
    
    <a href="https://binnz.github.io/" title="California Dreaming">California Dreaming</a>
    
  </p>
</div>
</footer>
  <script src="https://binnz.github.io/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript">
done = false;
$(document).ready(function(){
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize();
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  $('form.search').on('submit', function (event) {
    if (false === done) {
      event.preventDefault();
      var orgVal = $(this).find('#search').val();
      $(this).find('#search').val('site:https:\/\/binnz.github.io\/ ' + orgVal);
      done = true;
      $(this).submit();
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{
    c.click(function(){
      ta.css('display', 'block').addClass('fadeIn');
    });
    o.click(function(){
      ta.css('display', 'none');
    });
    $(window).scroll(function(){
      ta.css("top",Math.max(140,320-$(this).scrollTop()));
    });
  };
});
</script>

<script type="text/javascript">
$(document).ready(function(){
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#share"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://b.bshare.cn/barCode?site=weixin&url=' + encodedUrl + '"/></div>',
  '<a href="#textlogo" class="article-back-to-top" title="Top"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="QRcode"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="Weibo"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});
</script>





</body>
</html>
